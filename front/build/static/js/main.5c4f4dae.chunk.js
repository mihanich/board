(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{122:function(e,t,a){},138:function(e,t,a){"use strict";(function(e){var n=a(15),r=a(8),o=a(7),i=a(0),c=a.n(i),s=a(139),l=a(140),u=a(141),d=a(145),m=(a(229),["a","b","c","d","e","f","g","h","i"]),f={lg:[{i:"a",x:0,y:0,w:4,h:4},{i:"b",x:0,y:0,w:4,h:4},{i:"c",x:0,y:0,w:4,h:4},{i:"d",x:4,y:4,w:4,h:4},{i:"e",x:4,y:4,w:4,h:4},{i:"f",x:4,y:4,w:4,h:4},{i:"g",x:8,y:8,w:4,h:4},{i:"h",x:8,y:8,w:4,h:4},{i:"i",x:8,y:8,w:4,h:4}]},h="type",v={VIDEO:["startPosition"],FRAME:["url"]},g={type:"video",startPosition:"",url:""},p={VIDEO:"video",FRAME:"frame"};t.a=Object(l.withSize)({refreshMode:"debounce",refreshRate:60})(function(t){var a=t.size.width,l=Object(i.useState)(m),b=Object(o.a)(l,2),E=b[0],y=b[1],O=Object(i.useState)([{a:Object(r.a)({},v.VIDEO,"")}]),V=Object(o.a)(O,2),w=V[0],j=V[1],I=Object(i.useState)([{a:g}]),x=Object(o.a)(I,2),k=x[0],N=x[1],C=Object(i.useState)([]),S=Object(o.a)(C,2),R=(S[0],S[1],Object(i.useState)(function(t){var a={};if(e.localStorage)try{a=JSON.parse(e.localStorage.getItem("rgl-8"))||{}}catch(n){}return a[t]}("layouts")||f)),B=Object(o.a)(R,2),F=B[0],A=B[1],T=function(e){y(E.filter(function(t){return t!==e}))},P=function(e){switch(e.target.value){case p.VIDEO:j(v.VIDEO),N.apply(void 0,Object(n.a)(g).concat([Object(r.a)({},h,p.VIDEO)]));break;case p.FRAME:j(v.FRAME),N.apply(void 0,Object(n.a)(g).concat([Object(r.a)({},h,p.FRAME)]));break;default:j(v.VIDEO)}},z=function(e){var t=e.target,a=t.value,o=t.name;N.apply(void 0,Object(n.a)(k).concat([Object(r.a)({},o,a)]))},D=function(e){e.preventDefault()};return c.a.createElement(c.a.Fragment,null,c.a.createElement(d.a,{onLayoutSave:function(){var t,a;t="layouts",a=F,e.localStorage&&e.localStorage.setItem("rgl-8",JSON.stringify(Object(r.a)({},t,a)))},items:E,onRemoveItem:T,onAddItem:function(e){y([].concat(Object(n.a)(E),[e]))},originalItems:m}),c.a.createElement(s.Responsive,{className:"layout",layouts:F,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},rowHeight:60,width:a,onLayoutChange:function(e,t){var a=t.lg&&t.lg.filter(function(e){return e.x>12||e.y>8});A(t),a.forEach(function(e){T(e.i)})},onResizeStop:function(e,t,a,n,r,o){a.w%4?a.w=a.w<t.w?t.w-4:t.w+4:a.h%4&&(a.h=a.h<t.h?t.h-4:t.h+4)}},E.map(function(e){return c.a.createElement("div",{key:e,className:"widget","data-grid":{w:4,h:4,x:0,y:1/0}},c.a.createElement(u.a,{id:e,onRemoveItem:T,backgroundColor:"#867ae9"},c.a.createElement("form",{className:"form",role:"form",onSubmit:D},c.a.createElement("div",{className:"form-group row"},c.a.createElement("label",{className:"col-lg-3 col-form-label form-control-label"},"Element type"),c.a.createElement("div",{className:"col-lg-9"},c.a.createElement("select",{className:"form-control",size:"0",onChange:P,required:!0,id:e},c.a.createElement("option",{value:"video"},"Video"),c.a.createElement("option",{value:"frame"},"frame")))),w.map(function(e,t){return console.log(e),c.a.createElement("div",{className:"form-group row",key:t},c.a.createElement("label",{className:"col-lg-3 col-form-label form-control-label"},e," value"),c.a.createElement("div",{className:"col-lg-9"},c.a.createElement("input",{type:"text",className:"form-control",value:k[e]||"",name:e,onChange:z,required:!0})))}),c.a.createElement("div",{className:"form-group row"},c.a.createElement("div",{className:"col-3"}),c.a.createElement("div",{className:"col-3"},c.a.createElement("input",{className:"btn btn-primary",type:"button",value:"Add to config"}))))))})))})}).call(this,a(88))},141:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(7),r=a(0),o=a.n(r),i=a(237),c=a(238),s=a(148),l=a(235),u=a(234),d=Object(i.a)({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},header:{display:"flex",alignItems:"center",padding:"0.5rem"},spacer:{flexGrow:1},body:{padding:"1rem 2rem",flexGrow:1}});function m(e){var t=e.id,a=e.onRemoveItem,i=e.children,m=d(),f=Object(r.useState)(""),h=Object(n.a)(f,2),v=h[0],g=h[1];return o.a.createElement(c.a,{className:m.root},o.a.createElement("div",{className:m.header},o.a.createElement("div",{className:m.spacer}),o.a.createElement(s.a,{"aria-label":"change view",onClick:function(){g(v?"":"active")}},o.a.createElement(u.a,{fontSize:"small"})),o.a.createElement(s.a,{"aria-label":"delete",onClick:function(){return a(t)}},o.a.createElement(l.a,{fontSize:"small"}))),o.a.createElement("div",{className:"".concat(m.body," ").concat(v," flip")},o.a.createElement("div",{className:"front"},i),o.a.createElement("div",{className:"back"},"VIDEO OR FRAME CONTENT")))}},145:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(238),i=a(237),c=a(148),s=a(144),l=a.n(s),u=a(7),d=a(264),m=a(270),f=a(269),h=a(271),v=a(267),g=a(266),p=a(143),b=a.n(p),E=Object(i.a)({popup:{padding:"0.5rem"}}),y={a:"BOX",b:"BOX",c:"BOX",d:"BOX",e:"BOX",f:"BOX",g:"BOX",h:"BOX",i:"BOX"};function O(e){var t=e.items,a=e.onRemoveItem,n=e.onAddItem,o=e.originalItems,i=E(),s=r.a.useState(null),l=Object(u.a)(s,2),p=l[0],O=l[1],V=Boolean(p),w=V?"simple-popover":void 0,j=function(e){e.target.checked?n(e.target.name):a(e.target.name)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{"aria-label":"add",onClick:function(e){O(e.currentTarget)},"aria-describedby":w},r.a.createElement(b.a,null)),r.a.createElement(d.a,{id:w,open:V,anchorEl:p,onClose:function(){O(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement("div",{className:i.popup},r.a.createElement(f.a,{component:"fieldset"},r.a.createElement(m.a,{component:"legend"},"Select Widgets"),r.a.createElement(h.a,null,o.map(function(e){return r.a.createElement(v.a,{control:r.a.createElement(g.a,{checked:t.includes(e),onChange:j,name:e}),label:y[e],key:e})}))))))}a.d(t,"a",function(){return w});var V=Object(i.a)({root:{padding:"0.5rem",width:"100%",display:"flex",justifyContent:"flex-end"}});function w(e){var t=e.onLayoutSave,a=e.items,n=e.onRemoveItem,i=e.onAddItem,s=e.originalItems,u=V();return r.a.createElement(o.a,{className:u.root},r.a.createElement(O,{items:a,onRemoveItem:n,onAddItem:i,originalItems:s}),r.a.createElement(c.a,{"aria-label":"save",onClick:t},r.a.createElement(l.a,null)))}},166:function(e,t,a){e.exports=a(231)},171:function(e,t,a){},196:function(e,t){},229:function(e,t,a){},231:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),i=a.n(o),c=(a(171),a(99)),s=a.n(c),l=a(136),u=a(15),d=a(27),m=a(28),f=a(40),h=a(36),v=a(41),g=a(137),p=a.n(g),b="http://127.0.0.1:3001/api/",E=(a(121),function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"video-wrapper"},r.a.createElement("video",{src:this.props.src,autoPlay:this.props.autoPlay,onEnded:this.props.onEnded,id:this.props.id,muted:!0}))}}]),t}(n.PureComponent)),y=(a(122),"video"),O="frame",V=function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(f.a)(this,Object(h.a)(t).call(this))).i=0,e.base64Videos=[],e.tmpBase64Videos=[],e.videos=[],e.updated=!1,e.updatedConfig=!1,e.setVideos=function(t){e.setState({freshVideos:t}),e.state.freshVideos.length?e.state.currentVideoIndexes.forEach(function(t,a){e.selectVideo(e.state.freshVideos[t],a)}):e.setState({currentVideos:[{name:null,file:null},{name:null,file:null}]})},e.selectVideo=function(t,a){var n=e.base64Videos.findIndex(function(e){return e.fileName===t.fileName}),r=Object(u.a)(e.state.currentVideos),o=Object(u.a)(e.state.currentVideoIndexes);o[a]=n,r[a]=t,e.setState({currentVideos:r,currentVideoIndexes:o})},e.updateControls=function(t,a){var n=Object.assign({},e.state.controls[a]);for(var r in t){var o=t[r];n[r]=o}var i=e.state.controls;i[a]=n,e.setState({controls:i})},e.onVideoEnd=function(t){t=t.currentTarget.id,e.updateControls({isEnded:!0},t);var a=0;if(e.state.freshVideos[e.state.currentVideoIndexes[t]+1])a=e.state.currentVideoIndexes[t]+1,e.selectVideo(e.state.freshVideos[a],t);else{var n=Object(u.a)(e.state.currentVideoIndexes);n[t]=0,e.setState({currentVideoIndexes:n}),a=0,e.selectVideo(e.state.freshVideos[a],t)}},e.state={configIsReturned:!1,videoIsReturned:!1,template:[],config:[{type:"video",startPosition:0,height:25,width:100}],freshVideos:[],currentVideos:[{file:null,fileName:null,onEnded:!1}],currentVideoIndexes:[],controls:[]},e}return Object(v.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.socket=p()("http://127.0.0.1:3002"),this.socket.on("video",function(t){console.log(t),e.setVideos(t.videos)}),this.socket.on("config",function(t){e.setState({config:t.config}),e.setState({configIsReturned:!0,currentVideoIndexes:e.getCurrentVideoIndex()})}),this.getConfig(),this.fetchAllVideos()}},{key:"getConfig",value:function(){var e=this;fetch(b+"config").then(function(e){return e.json()}).then(function(t){e.setState({config:t}),e.setState({configIsReturned:!0,currentVideoIndexes:e.getCurrentVideoIndex(),currentVideos:e.getCurrentVideos(),controls:e.getControls()})})}},{key:"fetchAllVideos",value:function(){var e=this;fetch(b+"videos").then(function(e){return e.json()}).then(function(t){e.tmpBase64Videos=[],e.i=0,e.videos=t.data,e.updated=!1,e.convertUrlTObase64(t.data),e.setState({videoIsReturned:!0})})}},{key:"render",value:function(){return r.a.createElement("main",{role:"main"},r.a.createElement("div",{className:"album bg-light"},r.a.createElement("div",{className:"box"},this.state.configIsReturned&&this.state.videoIsReturned?this.setTemplate():r.a.createElement("h1",null,"Loading..."))))}},{key:"getControls",value:function(){return this.filterConfig(y).map(function(e){return{autoPlay:!0,onEnded:!0}})}},{key:"setTemplate",value:function(){var e=this,t=-1;return this.state.config.map(function(a,n){return a.type===y?(t++,e.getVideoTemplate(t,n,a)):a.type===O?e.getFrameTemplate(a.url,n,a):void 0})}},{key:"getVideoTemplate",value:function(e,t,a){var n=a.width?a.width:"100",o=a.height?a.height:"100";if(this.state.currentVideos[e])return r.a.createElement("div",{className:"video-box",key:t,"data-width":n,"data-height":o},r.a.createElement(E,{src:this.state.currentVideos[e].file,autoPlay:this.state.controls[e].autoPlay,onEnded:this.onVideoEnd,data:this.state.currentVideos[e],id:e}))}},{key:"getFrameTemplate",value:function(e,t,a){var n=a.width?a.width:"100",o=a.height?a.height:"100";return r.a.createElement("div",{className:"frame-wrapper",key:t,"data-width":n,"data-height":o},r.a.createElement("iframe",{src:e,id:"myIFrame",title:"MyFrame",referrerPolicy:"no-referrer",className:"frame"}))}},{key:"getCurrentVideoIndex",value:function(){return this.filterConfig(y).map(function(e){return e.startPosition})}},{key:"getCurrentVideos",value:function(){return this.filterConfig(y).map(function(e){return{file:null,fileName:null,onEnded:!1}})}},{key:"filterConfig",value:function(e){return this.state.config.filter(function(t){if(t.type===e)return t})}},{key:"equals",value:function(e,t){return e.length===t.length}},{key:"checkUpdate",value:function(){var e=this;fetch(b+"videos").then(function(e){return e.json()}).then(function(t){e.updated=!e.equals(e.videos,t.data)}),fetch(b+"config").then(function(e){return e.json()}).then(function(t){e.updatedConfig=!e.equals(e.state.config,t)})}},{key:"convertUrlTObase64",value:function(e){var t=this,a=e[this.i];if(a){this.i++;var n=this.base64Videos.find(function(e){return e.fileName===a.fileName});n&&n.size===a.size?(this.tmpBase64Videos.push(n),this.convertUrlTObase64(e)):this.getBase64(a.file,a.fileName,function(n){var r={file:n,fileName:a.fileName,size:a.size};t.tmpBase64Videos.push(r),t.convertUrlTObase64(e)})}else this.base64Videos=Object.assign([],this.tmpBase64Videos),this.setVideos(this.base64Videos)}},{key:"getBase64",value:function(){var e=Object(l.a)(s.a.mark(function e(t,a,n){var r,o,i,c;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return r=e.sent,e.next=5,r.blob();case 5:o=e.sent,i={type:"video/"+a.split(".")[1]},t=new File([o],a,i),(c=new FileReader).readAsDataURL(t),c.onload=function(){n(c.result)},c.onerror=function(e){console.log("Error: ",e)};case 12:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}()}]),t}(n.PureComponent),w=a(138),j=function(e){function t(){var e;return Object(d.a)(this,t),(e=Object(f.a)(this,Object(h.a)(t).call(this))).config=[],e.state={},e}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{onLayoutChange:this.onLayoutChange}))}}]),t}(n.PureComponent),I=a(97),x=a(9);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(I.a,null,r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/",element:r.a.createElement(V,null)}),r.a.createElement(x.a,{path:"/setting",element:r.a.createElement(j,null)}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[166,1,2]]]);
//# sourceMappingURL=main.5c4f4dae.chunk.js.map